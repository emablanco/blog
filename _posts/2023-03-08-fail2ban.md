---
layout: single

title: PROTEGER SSH DE FUERZA BRUTA  

excerpt: "**FAIL2BAN** es un software para detecta y bloquea los ataques de fuerza bruta. Supervisa las entradas en los archivos de registro de los distintos servicios (SSH o FTP). Cuando detecta demasiados intentos fallidos de una misma dirección IP la bloquea durante un cierto período de tiempo.

date: 2022-06-10

classes: wide

header:

    teaser: /assets/imagen/fail2ban/logo.png

    teaser_home_page: true
    
    icon: /assets/images/logofairy.png

categories:

    - python3
    - bash

tags:  

- ScanHost
---

![](/assets/images/fail2ban/wallapapers.webp)


```bash

sudo apt update

sudo apt install fail2ban

sudo systemctl start fail2ban

sudo systemctl enable fail2ban

```
## Configurar Fail2ban

Los archivos de configuración de Fail2ban se encuentran en el directorio __/etc/fail2ban__. El archivo __jail.conf__ contiene la configuración predeterminada.
Si lo quese busca es modificar los parametros por defecto se puede crear el archivo __/etc/fail2ban/jail.local__. Éstos sobrescriben los valores respectivos de jail.conf.

* Evite cambiar la configuración del archivo __jail.conf__, ya que esto puede causar problemas con futuras actualizaciones de **Fail2ban**. 


```bash

sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local

sudo vi /etc/fail2ban/jail.local

```

Aumentar el tiempo que se banea una dirección IP atacante. 

* bantime  = 10m 

Lo aumento a 86400, que equivalen a 24hs 

```
# "bantime" is the number of seconds that a host is banned.
bantime  = 86400

```

```
sudo systemctl restart fail2ban 

sudo less /var/log/fail2ban.log

```
En el log se pueden ver el tiempo establecido de baneo.

![](/assets/images/fail2ban/log.png)

- [Manual fail2ban](https://www.fail2ban.org/wiki/index.php/MANUAL_0_8)

 
 - [ ] Siguiendo esta guia de buensas practivas puedo generar una jaula para ssh con la siguiente configuracion:

```bash
[DEFAULT]

 bantime.increment    = true
 bantime.rndtime      = 30m
 bantime.maxtime      = 60d
 bantime.factor       = 2
 bantime.formula      = ban.Time * math.exp(float(ban.Count+1)*banFactor)/math.exp(1*banFactor)
 bantime.overalljails = true
 maxretry = 3
 
 [sshd]
 enabled = true
```
